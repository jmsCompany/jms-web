<script type="text/template" id="companyCreate">
	<div class="container-fluid">
		<div class="row">
			<section>

				<div class="body-head-title">
					<span class="h-title" id="po1">PO</span>
					<span class="h-title" id="createPo">Maintain PO</span>
					<span class="h-title" id="cocoMpany">Supplier</span>
					<span class="h-title-selected" id="createCo"><b>Create supplier</b></span>
					<span class="h-title" id="importPo">Import PO</span>
				</div>
				<form id="cocompanyForm" method="post" action="index.html" class="form-inline">
					<div class="form-box">
						<div class="clearfix"></div>
						<div class="title-box">
							<span>Basic information</span>
						</div>
						<div class="col-xs-12 mar-top-20px">
							<div class="form-group">
								<label for="exampleInputEmail1" class="input-w-160">Company code</label>
								<input class="form-control input-w-300"  placeholder="" name="code" id="code">
								</div>
							</div>
							<div class="col-xs-12 mar-top-20px">
								<div class="form-group">
									<label for="exampleInputEmail1" class="input-w-160">Short name</label>
									<input class="form-control input-w-300"  placeholder="" name="shortName" id="shortName">
									</div>
								</div>
								<div class="col-xs-12 mar-top-20px">
									<div class="form-group">
										<label for="exampleInputEmail1" class="input-w-160">Name</label>
										<input class="form-control input-w-300" placeholder="" name="name" id="name">
										</div>
									</div>
									<input type="hidden" id="typeId" name="typeId:number" value="1"/>
									<!--<div class="col-xs-12 mar-top-20px">-->
										<!--<div class="form-group">-->
											<!--<label for="exampleInputEmail1" class="input-w-160">公司类别</label>-->
											<!--<select  class="input-w-3 select-cs1 form-control" name="typeId:number" id="typeId">-->
											<!--</select>-->
										<!--</div>-->
									<!--</div>-->
									<div class="col-xs-12 mar-top-20px">
										<div class="form-group">
											<label for="exampleInputEmail1" class="input-w-160">Level</label>
											<select  class="input-w-3 select-cs1 form-control" name="lvlId:number" id="lvlId">
											</select>
											<!--<select name="公司类别" class="form-control  select-cs1 input-w-300">
                                                <option value="">公司类别1</option>
                                            </select>-->
										</div>
									</div>
									<div class="col-xs-12 mar-top-20px">
										<div class="form-group">
											<label for="exampleInputEmail1" class="input-w-160">Telephone</label>
											<input class="form-control input-w-3" placeholder="" name="tel" id="tel">
											</div>
											<div class="form-group">
												<label for="exampleInputEmail1" class="input-w-160">Fax</label>
												<input class="form-control input-w-3" placeholder="" name="fax" id="fax">
												</div>
											</div>
											<div class="col-xs-12 mar-top-20px">
												<div class="form-group">
													<label for="exampleInputEmail1" class="input-w-160">Actual address</label>
													<input class="form-control input-w-300" id="addressAct" name="addressAct" placeholder="">
													</div>
												</div>
												<div class="col-xs-12 mar-top-20px">
													<div class="form-group">
														<label for="exampleInputEmail1" class="input-w-160">Registered address</label>
														<input class="form-control input-w-300" id="addressReg" name="addressReg" placeholder="">
														</div>
													</div>
													<div class="col-xs-12 mar-top-20px">
														<div class="form-group">
															<label for="exampleInputEmail1" class="input-w-160 ">Countries and regions</label>
															<select  class="input-w-3 select-cs1 form-control" name="countryId:number" id="countryId">
															</select>
														</div>
														<div class="form-group">
															<label for="exampleInputEmail1" class="input-w-160">Legal representative</label>
															<input class="form-control input-w-3" id="artificialPerson" name="artificialPerson" placeholder="">
															</div>
														</div>
														<div class="col-xs-12 mar-top-20px">
															<div class="form-group">
																<label for="exampleInputEmail1" class="input-w-160">Company website</label>
																<input class="form-control input-w-300" id="url" name="url" placeholder="">
																</div>
															</div>
															<div class="clearfix"></div>
															<div class="title-box">
																<span>Transaction information</span>
															</div>
															<!--
                                                            <div class="col-xs-12 mar-top-20px">
                                                                <div class="form-group">
                                                                    <label for="exampleInputEmail1" class="input-w-160">公司税号</label>
                                                                    <input class="form-control input-w-300" id="taxNo" name="taxNo" placeholder="">
                                                                </div>
                                                            </div>-->
															<div class="col-xs-12 mar-top-20px">
																<div class="form-group">
																	<label for="exampleInputEmail1" class="input-w-160">Deposit bank</label>
																	<input class="form-control input-w-300" id="bank" name="bank" placeholder="">
																	</div>
																</div>
																<div class="col-xs-12 mar-top-20px">
																	<div class="form-group">
																		<label for="exampleInputEmail1" class="input-w-160">Bank account</label>
																		<input class="form-control input-w-300" id="bankAccNo" name="bankAccNo" placeholder="">
																		</div>
																	</div>
																	<div class="col-xs-12 mar-top-20px">
																		<div class="form-group">
																			<label for="exampleInputEmail1" class="input-w-160">Freight term</label>
																			<select  class="input-w-3 select-cs1 form-control" name="freightTermId:number" id="freightTermId">
																			</select>
																		</div>
																	</div>
																	<div class="col-xs-12 mar-top-20px">
																		<div class="form-group">
																			<label for="exampleInputEmail1" class="input-w-160">Payment term</label>
																			<select  class="input-w-3 select-cs1 form-control" name="paymentTermId:number" id="paymentTermId">
																			</select>
																		</div>
																	</div>
																	<div class="col-xs-12 mar-top-20px">
																		<div class="form-group">
																			<label for="exampleInputEmail1" class="input-w-160">Auditor</label>
																			<input class="form-control input-w-300" id="auditBy" name="auditBy" placeholder="">
																			</div>
																		</div>
																		<div class="col-xs-12 mar-top-20px">
																			<div class="form-group">
																				<label for="exampleInputEmail1" class="input-w-160">Status</label>
																				<input type="radio" name="statusId:number" id="status21" class="radio-w" value="21"/><label for="stateOn">有效</label>
																				<input type="radio" name="statusId:number" id="status22" class="radio-w" value="22" /><label for="stateOoff">无效</label>
																			</div>
																		</div>
																		<div class="col-xs-12 mar-top-20px">
																			<div class="form-group">
																				<label for="exampleInputEmail1" class="input-w-160">Remark</label>
																				<textarea class="form-control input-w-300" rows="3" id="remark" name="remark"></textarea>
																			</div>
																		</div>
																		<div class="col-xs-12 mar-top-20px">
																			<div class="form-group">
																				<label for="exampleInputEmail1" class="input-w-160">Auto remark</label>
																				<textarea class="form-control input-w-300" rows="3" id="autoRemark" name="autoRemark"></textarea>
																			</div>
																		</div>
																		<!--<div class="clearfix"></div>
                                                                        <div class="title-box">
                                                                            <span>公司认证</span>
                                                                        </div>
                                                                        <div class="col-xs-12 mar-top-20px">
                                                                            <div class="form-group">
                                                                                <label for="exampleInputEmail1" class="input-w-160">上传附件</label>
                                                                                <input type="file" class="inherit" id="exampleInputEmail1" name="url" placeholder="">
                                                                            </div>
                                                                        </div>-->

																	</div>

																	<div class="clearfix"></div>
																	<div class="foot-btn-box">
																		<div class="form-group">
																			<button type="submit" class="btn btn-primary" id="save">Save</button>
																			<button type="button" class="btn  btn-info" id="return01">Return</button>
																		</div>
																	</div>
																	<input type="hidden" id="id" name="id:number"/>
																</form>
															</section>
														</div>
													</div>
</script>
<script type="text/javascript">
	var params = RouterManager.getParams();
		var app={
			init:function(){
				$('#body').html($('#companyCreate').html())
				this.bindEvents();
			},
			bindEvents:function(){
				var id = params['coCompanyId'];
				var companyCoTypeId = params['companyCoTypeId'];
				if(companyCoTypeId == 2){
					$('#po1').html('SO');
					$('#createPo').html('Maintain SO');
					$('#cocoMpany').html('Client');
					$('#createCo').html('<b>Create client</b>');
					$('#typeId').val(2);
					$('#po1').click(function(){
						$.get("views/so.html",function(data){
							RouterManager.setUrl({
								groupId:'so'
							});
							$("#body").html(data);
						});
					});
					$('#createPo').click(function(){
						$.get("views/so-order.html",function(data){
							RouterManager.setUrl({
								groupId:'so',
								viewId:'so-order'
							});
							$("#body").html(data);
						});
					});
				}
				else{
					// 采购订单
					$('#po1').click(function(){
						$.get("views/po.html",function(data){
							RouterManager.setUrl({
								groupId:'po'
							});
							$("#body").html(data);
						});
					});
					//	创建采购订单
					$('#createPo').click(function(){
						$.get("views/po-order.html",function(data){
							RouterManager.setUrl({
								groupId:'po',
								viewId:'po-order'
							});
							$("#body").html(data);
						});
					});
				}

				$('#cocoMpany').click(function(){
					$.get("views/cocompany.html",function(data){
						RouterManager.setUrl({
							groupId:'po',
							viewId:'cocompany',
							companyCoTypeId:companyCoTypeId
						});
						$("#body").html(data);
					});
				});

                // 采购订单导入
                $('#importPo').click(function(){
                    $.get("views/po-import.html",function(data){
                        RouterManager.setUrl({
                            groupId:'po',
                            companyCoTypeId:'1',
                            viewId:'po-import'
                        });
                        $("#body").html(data);
                    });
                });

				$('#typeId').selectautofill('s/companyCoTypes',{headers:{'JMS-TOKEN':store.get('JMS-TOKEN')}});
				$('#lvlId').selectautofill('s/companyCoLevels',{headers:{'JMS-TOKEN':store.get('JMS-TOKEN')}});
				$('#freightTermId').selectautofill('s/terms',{headers:{'JMS-TOKEN':store.get('JMS-TOKEN')},data:{'source':'freight'}});
				$('#paymentTermId').selectautofill('s/terms',{headers:{'JMS-TOKEN':store.get('JMS-TOKEN')},data:{'source':'payment'}});
				$('#countryId').selectautofill('s/countries',{headers:{'JMS-TOKEN':store.get('JMS-TOKEN')}});


				var isEdit = params['action']=='edit';
				$('#id').val(id);
				var jmstoken= store.get('JMS-TOKEN');
				if(id!=null){

					$.cocompanyInfo(id,jmstoken,function(data){
						$('#cocompanyForm').populate(data,true);
						if(data.status=='有效'){
							$('#status21').attr('checked',true);
						}
						else{
							$('#status22').attr('checked',true);
						}
					});
					if(!isEdit){
						$('input,select,textarea').prop('readonly',true);
						$('select').prop('disabled',true);
						$('.radio-w').prop('disabled',true);
						$("input:not(:button,:hidden)").prop("readonly", true);
						$('#save').hide();
						if(companyCoTypeId == 1){
							$('#createCo').html('<b>Supplier detail</b>');
						}
						else{
							$('#createCo').html('<b>Client detail</b>');
						};
					}
					else{
						if(companyCoTypeId == 1){
							$('#createCo').html('<b>Edit supplier</b>');
						}
						else{
							$('#createCo').html('<b>Edit client</b>');
						};
					}
				}
				else{
					$('#status21').attr('checked',true);
				}

				$('#cocompanyForm').bootstrapValidator({
					message: 'This value is not valid',
					feedbackIcons: {
						valid: 'glyphicon glyphicon-ok',
						invalid: 'glyphicon glyphicon-remove',
						validating: 'glyphicon glyphicon-refresh'
					},
					fields: {
						'code': {
							validators: {
								notEmpty: {
									message: 'Company code can not be empty.'
								},
//								regexp: {
//									regexp: /^([a-z_A-Z-.+0-9]+)$/,
//									message: '只能是数字、字母、加减号、下划线、点。'
//								},
							}
						},
						'shortName': {
							validators: {
								notEmpty: {
									message: 'Short name can not be empty.'
								},
								regexp: {
									regexp: /^[a-zA-Z0-9\u4e00-\u9fa5]+$/,
									message: 'Only Chinese, letters, Numbers, underscores.'
								},
							}
						},
						'name': {
							validators: {
								notEmpty: {
									message: 'Name can not be empty.'
								},
								regexp: {
									regexp: /^[a-zA-Z0-9\u4e00-\u9fa5]+$/,
									message: 'Only Chinese, letters, Numbers, underscores.'
								},
							}
						},
                    	'tel': {
                        	validators: {
                            	phone: {
                                	message: 'Format is illegal',
                                	country: 'CN'
                            	}
                        	}
                    	},
						'fax': {
							validators: {
								digits: {
									message: 'Format is illegal'
								}
							}
						},
						'bankAccNo': {
							validators: {
								digits: {
									message: 'Format is illegal'
								}
							}
						},
						'addressAct': {
							validators: {
								regexp: {
									regexp: /^(?!_)(?!.*?_$)[a-zA-Z0-9_\u4e00-\u9fa5]+$/,
									message: 'Only Chinese, letters, Numbers, underscores.'
								},
							}
						},
						'addressReg': {
							validators: {
								regexp: {
									regexp: /^(?!_)(?!.*?_$)[a-zA-Z0-9_\u4e00-\u9fa5]+$/,
									message: 'Only Chinese, letters, Numbers, underscores.'
								},
							}
						},
						'artificialPerson': {
							validators: {
								regexp: {
									regexp: /^[a-zA-Z\u4e00-\u9fa5]+$/,
									message: 'Only Chinese, letters.'
								},
							}
						},
						'bank': {
							validators: {
								regexp: {
									regexp: /^(?!_)(?!.*?_$)[a-zA-Z0-9_\u4e00-\u9fa5]+$/,
									message: 'Only Chinese, letters, Numbers, underscores.'
								},
							}
						},
						'auditBy': {
							validators: {
								regexp: {
									regexp: /^[a-zA-Z\u4e00-\u9fa5]+$/,
									message: 'Only Chinese, letters.'
								},
							}
						},
					}
				}).on('success.form.bv', function(e) {
					e.preventDefault();
					var $form     = $(e.target),
							validator = $form.data('bootstrapValidator');
					var cocompany =JSON.stringify($('#cocompanyForm').serializeJSON());
					var jmstoken= store.get('JMS-TOKEN');
					$.saveCocompany(cocompany,jmstoken,function(data){
//						$.get("views/cocompany.html",function(data){
//							$("#body").html(data);
//						});
						history.go(-1);
					});
				});

				$('#return01').click(function(){
					history.go(-1);
//					$.get("views/cocompany.html",function(data){
//						$("#body").html(data);
//					});
				});

			}
		};
		app.init();
//	}
</script>
